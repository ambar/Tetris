
# 细节

* 明暗变化的颜色，用HSL比RGB方便太多了。
* 画多边形时，斜线会有黑色的锯齿，可以再在上面画一条线段解决。
* canvas 绘制文字消耗太大，尤其是firefox。一定要用的话，新建一个 canvas 层做背景，文字绘制到它上面，并用CSS定位把它到主画布下面。
* 未开户硬件加速的情况下，仅仅绘制普通矩形，半屏之后也很卡。

# [AMD](http://wiki.commonjs.org/wiki/Modules/AsynchronousDefinition)

CommonJS 倡议的模块定义方式，干掉了老套的用全局变量做命名空间的形式。
与老式的命名空间相比，AMD 的方式更加容易组织代码，结构也更干净、更一致。

这个游戏花了我几个小时来做转换，总结：

* 如果一个模块是一组功能的集合，就用 exports
* 如果一个模块是一个单一的类，就用 module.exports
* 模块定义(define函数)的第一个参数‘模块名’是完全无意义的。我开始为了能够简单的合并文件，就全部命名了一遍，后面发现太麻烦——因为你要引用它时，就可能不得不打开文件去找它取了什么名字，这很悲剧。后面就自然的全部改了。**文件的摆放层次** 就是就是你的命名空间，这应该是 AMD 隐含的核心理念。

seajs 实际使用上，可能会碰到的问题：

* 循环引用。seajs 会报一个警告，仔细检查可以排除。但是，不排除也可以工作。有点纠结，现在的折衷做法是导出了一个全局变量 TetrisGame。
* define 第二个依赖参数也可能会出现模块引用的奇怪问题。同样是循环引用，但没有错误提示什么的，加载的模块也没有加载到——许久之后，提示超时了。